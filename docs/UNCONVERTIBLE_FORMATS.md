# Форматы файлов, которые не могут быть преобразованы в Markdown

Дата: 14 января 2026

## Обзор

Из 7,184 файлов в папке `/Клиенты`, **6,246 файлов (86.9%)** успешно преобразуются в Markdown. Оставшиеся файлы не могут быть преобразованы по различным техническим причинам или по требованию пользователя.

## Категории непреобразуемых форматов

### 1. Мультимедиа файлы (не преобразуются по требованию пользователя)

#### Видео файлы (607 файлов, 8.4%)
- **Форматы**: `.mp4`, `.webm`
- **Причина**: Преобразование видео в текст не имеет смысла. Можно было бы извлечь метаданные (длительность, разрешение, кодек), но это не дает полезной информации о содержимом.
- **Альтернатива**: Создаются пустые файлы-заглушки для сохранения структуры папок.

#### Изображения (129 файлов, 1.8%)
- **Форматы**: `.png`, `.jpg`, `.jpeg`, `.svg`, `.tif`
- **Причина**: По требованию пользователя изображения не преобразуются. Возможны варианты:
  - OCR для извлечения текста из изображений (требует Tesseract)
  - Встраивание изображений в Markdown через base64
  - Описание изображения через AI (требует API)
- **Текущее решение**: Не преобразуются по требованию.

#### Аудио файлы (9 файлов, 0.1%)
- **Форматы**: `.mp3`, `.ogg`, `.m4a`
- **Причина**: Преобразование аудио в текст требует speech-to-text API (Google Cloud, AWS Transcribe, OpenAI Whisper). Это дорого и сложно для локальной обработки.
- **Альтернатива**: Можно извлечь только метаданные (длительность, битрейт, артист).

### 2. Архивы (64 файла, 0.9%)

#### ZIP и 7-Zip
- **Форматы**: `.zip`, `.7z`
- **Причина**: Архивы - это контейнеры для других файлов. Для преобразования нужно:
  1. Распаковать архив во временную папку
  2. Рекурсивно обработать все файлы внутри
  3. Создать объединенный Markdown с содержимым всех файлов
- **Проблема**: Сложность реализации, большой расход ресурсов, риск дублирования данных.
- **Статус**: Не реализовано, но технически возможно.

#### Snappy сжатие (.snappy)
- **Количество**: 4 файла
- **Причина**: Snappy - это алгоритм сжатия, а не формат файла. Нужно знать, что сжато внутри (обычно используется с Parquet или другими форматами).

### 3. Проприетарные форматы (88 файлов, 1.2%)

#### Microsoft Project (.mpp)
- **Количество**: 44 файла (93.7 МБ)
- **Причина**: Проприетарный бинарный формат Microsoft Project. Нет надежных библиотек Python для чтения.
- **Возможные решения**:
  - COM-автоматизация через pywin32 (требует установленный MS Project на Windows)
  - Конвертация через MS Project Online API (требует подписку)
  - Использование Project Libre (открытый аналог, но не всегда корректно читает .mpp)

#### Power BI (.pbix)
- **Количество**: 10 файлов (23.9 МБ)
- **Причина**: PBIX - это ZIP-архив с множеством бинарных файлов (модели данных, визуализации, настройки). Формат очень сложный и закрытый.
- **Возможные решения**:
  - Power BI REST API для экспорта данных (требует Power BI Premium)
  - Извлечение отдельных компонентов (DataModel, Report) - очень сложно

#### 1С Предприятие (.epf, .erf)
- **Форматы**: `.epf` (внешние обработки), `.erf` (внешние отчеты)
- **Количество**: 12 файлов
- **Причина**: Проприетарный бинарный формат 1С. Для чтения требуется:
  - Установленная платформа 1С
  - COM-автоматизация или встроенные средства 1С
- **Статус**: Невозможно без 1С.

#### Diagrams.net/Draw.io (.drawio)
- **Количество**: 22 файла (5.9 МБ)
- **Причина**: XML-формат диаграмм. Можно прочитать структуру, но визуализация потеряется.
- **Возможные решения**:
  - Экспорт в PNG/SVG через draw.io CLI (требует установку)
  - Парсинг XML и текстовое описание структуры (малоинформативно)

#### Web Archive (.mht)
- **Количество**: 1 файл
- **Причина**: MHTML - сложный формат веб-архива (HTML + встроенные ресурсы в MIME).
- **Возможные решения**:
  - Библиотека `mht2html` для Python (устаревшая)
  - Открытие через браузер и сохранение как HTML
- **Статус**: Возможно, но сложно и не критично (1 файл).

### 4. Системные и временные файлы (36 файлов, 0.5%)

#### Ярлыки Windows (.lnk)
- **Причина**: Системные файлы Windows, содержат только путь к целевому файлу. Не имеют самостоятельной ценности.

#### Временные файлы (.tmp, .dtmp, .bkp)
- **Количество**: ~22 файла
- **Причина**: Временные или резервные копии. Обычно дубликаты других файлов или неполные данные.
- **Рекомендация**: Исключить из синхронизации.

#### Remote Desktop Protocol (.rdp)
- **Причина**: Конфигурационные файлы для подключения к удаленным рабочим столам. Содержат только настройки (IP, порт, параметры), не требуют преобразования.

### 5. Неизвестные форматы (небольшое количество)

#### .2025, .sel
- **Причина**: Неизвестные расширения, скорее всего специфичные для какого-то приложения или результат ошибки именования.
- **Статус**: Невозможно определить формат без анализа содержимого.

#### Файлы без расширения
- **Количество**: 4 файла (0 байт)
- **Причина**: Невозможно определить тип файла без расширения. Можно попытаться определить по magic bytes, но это сложно.

### 6. Форматы с ограничениями

#### PowerPoint старый формат (.ppt)
- **Количество**: 5 файлов (4.1 МБ)
- **Статус**: ⚠️ Ограниченная поддержка
- **Причина**: Библиотека `python-pptx` не поддерживает старый бинарный формат `.ppt` (только `.pptx`).
- **Решение**:
  - Конвертация `.ppt → .pptx` через LibreOffice CLI:
    ```bash
    soffice --headless --convert-to pptx file.ppt
    ```
  - Требует установку LibreOffice на машине
- **Текущий статус**: Converter пытается обработать, но выдаст ошибку для .ppt файлов.

## Технические решения для будущего

### Что можно было бы добавить:

1. **Архивы**: Рекурсивная обработка содержимого ZIP/7z
2. **Изображения с текстом**: OCR через Tesseract/EasyOCR
3. **Аудио**: Speech-to-text через OpenAI Whisper (локально) или cloud API
4. **Draw.io**: Экспорт через draw.io CLI
5. **.mht**: Конвертация через mht2html или браузерные инструменты
6. **.ppt**: Автоматическая конвертация через LibreOffice CLI

### Что невозможно/нецелесообразно:

1. **Видео**: Нет смысла преобразовывать видео в текст
2. **Microsoft Project**: Требует установленный MS Project или дорогой API
3. **Power BI**: Слишком сложный формат, нужен Power BI Premium
4. **1С форматы**: Требуется установленная платформа 1С
5. **Системные файлы**: Не имеют ценности для преобразования

## Итоговая статистика

| Категория | Файлов | % от всех | Статус |
|-----------|--------|-----------|--------|
| ✅ Преобразуются | 6,246 | 86.9% | Реализовано |
| ⚠️ Ограничено | 5 | 0.1% | Частично работает |
| ❌ Мультимедиа | 745 | 10.4% | По требованию пользователя |
| ❌ Архивы | 64 | 0.9% | Технически сложно |
| ❌ Проприетарные | 88 | 1.2% | Нет доступных библиотек |
| ❌ Системные/временные | 36 | 0.5% | Не имеет смысла |
| **Итого** | **7,184** | **100%** | - |

## Рекомендации

1. **Исключить из синхронизации**: `.tmp`, `.dtmp`, `.bkp`, `.lnk`, `.rdp`
2. **Оставить как есть**: Видео, аудио, изображения (по требованию пользователя)
3. **Возможно улучшить** (если нужно):
   - Добавить обработку архивов
   - Добавить OCR для изображений с текстом
   - Добавить конвертацию .ppt через LibreOffice

## Заключение

Текущая реализация покрывает **86.9% всех файлов**, что является отличным результатом. Оставшиеся 13.1% либо не требуют преобразования (видео, изображения), либо технически невозможно преобразовать без специального ПО или сервисов.
